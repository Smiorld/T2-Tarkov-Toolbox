# 更新日志

## [2025-12-07] - 重大架构调整

### 🎯 核心变化
- **移除任务追踪模块**：将任务追踪功能移至未来规划，当前版本专注于屏幕滤镜和本地地图两大核心功能

### ✨ 新增功能
- **悬浮窗对冲系统**：
  - 在屏幕滤镜模块中新增悬浮窗对冲设置
  - 防止地图悬浮窗在使用屏幕滤镜时过曝
  - 支持亮度、伽马、对比度独立对冲
  - 快捷键切换预设时自动应用对冲

- **地图模块滤镜支持**：
  - MapCanvas新增图片级别滤镜功能
  - 支持亮度、对比度、伽马调整
  - 使用PIL ImageEnhance和NumPy实现
  - 智能缓存机制（滤镜参数纳入缓存key）

### 🔧 技术改进
- **模块间通信优化**：
  - 通过回调方式连接ScreenFilterUI和OverlayWindow
  - 避免循环依赖，保持模块独立性

- **代码重构**：
  - 统一对冲应用逻辑到 `_apply_overlay_compensation()` 方法
  - 支持传入config参数或使用当前预设
  - 提高代码复用性

### 📚 文档更新
- 创建 `docs/DEVELOPMENT_ROADMAP.md` - 详细的开发路线图
- 更新 `README.md` - 反映当前功能状态
- 更新项目结构说明

### 🗑️ 清理工作
- 移除UI中的任务追踪标签页
- 移除相关import引用
- 清理临时测试文件
- 保留 `test_overlay_compensation.py` 作为功能验证

### 🧪 测试
- ✅ 悬浮窗对冲功能测试通过
- ✅ 快捷键切换时对冲同步测试通过
- ✅ 滤镜逻辑（亮度、对比度、伽马）测试通过
- ✅ 数据模型完整性测试通过

---

## [之前版本] - 核心功能实现

### 屏幕滤镜模块
- ✅ 多预设管理
- ✅ 快捷键支持
- ✅ 多显示器支持
- ✅ 参数安全验证
- ✅ 值映射系统

### 本地地图模块
- ✅ 实时位置追踪
- ✅ 多地图/多层级支持
- ✅ 校准系统（多种算法）
- ✅ 悬浮窗小地图
- ✅ 坐标转换系统
- ✅ 滚轮缩放支持
- ✅ 状态持久化

### 全局设置模块
- ✅ 基础配置界面
- ✅ 主题设置

---

## 未来计划

详见 [docs/DEVELOPMENT_ROADMAP.md](docs/DEVELOPMENT_ROADMAP.md)

- 📋 任务追踪器（规划中）
- 🎯 市场价格监控
- 🔧 武器配件构建器
- 🗺️ 战术路线规划
